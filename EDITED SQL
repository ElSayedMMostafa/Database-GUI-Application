--Create DataBase called "ReNile" --
CREATE DATABASE ReNile
-- Using the database to add the tables-- 
USE DATABASE ReNile
Go
 -- Create the Tables --
 CREATE TABLE FishFarm (
	ID VARCHAR(9) NOT NULL,
	SIZE INTEGER,
	CITY VARCHAR(50),
	FarmState VARCHAR(50),
	AUTOMATED VARCHAR(1),
	PH INTEGER,
	DO INTEGER,
    PRIMARY KEY (ID),
 ); --
 CREATE TABLE FishType(
	FTYPE VARCHAR(50) NOT NULL,
	ID VARCHAR(9),
	PRIMARY KEY (FTYPE,ID),
	FOREIGN KEY (ID) REFERENCES FishFarm 
 ); --
 CREATE TABLE Products(
	MANUFACTURER VARCHAR(50),
	PTYPE VARCHAR(50),
	QUNATITY INTEGER,
	PRICE INTEGER,
	PRIMARY KEY (MANUFACTURER,PTYPE)
 );--
 CREATE TABLE ImplementedIn(
	MANUFACTURER VARCHAR(50),
	PTYPE VARCHAR(50),
	ID VARCHAR(9),
	FOREIGN KEY (ID) REFERENCES FishFarm,
	FOREIGN KEY (MANUFACTURER,PTYPE) REFERENCES Products
 );--
 CREATE TABLE FarmOwner(
	CODE VARCHAR(10),
	FINANCIAL_ACCOUNT VARCHAR(50),
	PNAME VARCHAR(50),
	LNAME VARCHAR(50),
	PREMIUM_ACCOUNT VARCHAR(50),
	PRIMARY KEY (CODE)
 );--
 ALTER TABLE FishFarm ADD CODE VARCHAR(10);
 ALTER TABLE FishFarm ADD DOCTORID VARCHAR(9);
 ALTER TABLE FishFarm ADD EMPLOYEEID VARCHAR(9);
 ALTER TABLE FishFarm ADD FOREIGN KEY (CODE) REFERENCES FarmOwner;
 CREATE TABLE Doctor(
 DOCTORID VARCHAR(9),
 DFNAME VARCHAR(50),
 DLNAME VARCHAR(50),
 DADDRESS VARCHAR(50),
 DPHONE VARCHAR(50),
 PRIMARY KEY (DOCTORID)
 );--
 CREATE TABLE Employee(
 EMID VARCHAR(9),
 EFNAME VARCHAR(50),
 ELNAME VARCHAR(50),
 ESALARY INTEGER,
 DROLE VARCHAR(50),
 PRIMARY KEY (EMID)
 );--
 CREATE TABLE Importers (
	I_FINANCIAL_ACCOUNT VARCHAR(50),
	I_NAME VARCHAR(50),
	MANUFACTURER VARCHAR(50),
	PTYPE VARCHAR(50),
	PRIMARY KEY (I_NAME),
	FOREIGN KEY (MANUFACTURER,PTYPE) REFERENCES Products
 );--
 CREATE TABLE ImportedFrom(
	DEALDATE VARCHAR(50),
	I_NAME VARCHAR(50),
	MANUFACTURER VARCHAR(50),
	PTYPE VARCHAR(50),
	FOREIGN KEY (I_NAME) REFERENCES Importers,
	FOREIGN KEY (MANUFACTURER,PTYPE) REFERENCES Products
 );--
 CREATE TABLE Buy(
 Pmanufacturer varchar(50),
 Ptype varchar(50),
 Ocode varchar(10),
 quantity integer,
 total integer,
 PRIMARY KEY (Pmanufacturer,Ptype,Ocode),
 FOREIGN KEY (Pmanufacturer,Ptype) REFERENCES Products,
 FOREIGN KEY (Ocode) REFERENCES FarmOwner
 );
 CREATE TABLE Meet(
 Ocode varchar(10),
 DOCTORID VARCHAR(9),
 MeetDate Date,
 Alert	varchar(1),
 PRIMARY KEY(Ocode,DOCTORID),
 FOREIGN KEY(Ocode) REFERENCES FarmOWner,
 FOREIGN KEY(DOCTORID) REFERENCES Doctor,
 );
CREATE TABLE Alerts(
ID varchar(9) NOT NULL,
DOCTORID varchar(9) NOT NULL, 
Message varchar(50),
FOREIGN KEY(ID) REFERENCES FishFarm,
FOREIGN KEY(DOCTORID) REFERENCES Doctor,
PRIMARY KEY(ID,DOCTORID)

);
